; *********************************************
; *  341 Programming Languages                *
; *  Fall 2019                                *
; *  Author: Yakup Genc                       *
; *********************************************

;Yusuf Patoglu
;151044027


;;;-----------------------------------------------------------------PLEASE READ THIS----------------------------------------------------------------------------------------------------;;;
;;Notes to Ozgu Hoca:
;;I prepared a test version of my code for smaller alphabet. Simply I created my own alphabet and encoding it via singleDecode-test function. Also added my own word dictionary and document.
;;
;;You can download it on: https://drive.google.com/drive/folders/1LNQxIf3HyIxHWZYd0hWniGzOwY3Gue-Y?usp=sharing
;;;-----------------------------------------------------------------PLEASE READ THIS----------------------------------------------------------------------------------------------------;;;



;; utility functions 
(load "include.lisp") ;; "c2i and "i2c"





;; -----------------------------------------------------
;; HELPERS
;; *** PLACE YOUR HELPER FUNCTIONS BELOW ***
(defun count-times (list element)
  (loop for value in list count (equal value element)))

(defun set-hash-table()
    (defvar wordtable (make-hash-table :test 'equal)) ;required global value here. Otherwise lots of memory will be consumed.
    (let ((in (open "dictionary2.txt" :if-does-not-exist nil)))
    (when in
      (loop for line = (read-line in nil)
        while line do 
            (setf(gethash line wordtable) 1))
    (close in))))

(defun list-to-string (lst)
    (format nil "窿祗舂或弭躜铙蜥钿镯疱蝽豸狒轱镦扉篝昏趑痼函篝徙腼鲥蜴祜鳟泔懑聃弩糸镱蟑垂垂暗当栾鳝麸箬蹑骒瀛扉篝轭扉箴ㄤ彐躅铙桴骀戾箦聃孱沐祜镳骘骝镯戾铉翳箦聃孱沐滹黝麸滹蝻翎翦ㄥ祠箦聃孱沐蜥钿镯椹ㄥ祠箦聃孱沐ū椹┅箦聃孱沐黄灬趑孱翳铄篝邃扉篝昏趑痼函蝻箦趑徙镤瀹矧绡鏖腴旗狒翦钸徇扉篝Ｃ镯盹钸涕箴ㄤ彐躅骒狒翦篝蝓泗躜濠ㄣ镱è铛祆篝蝓泗躜濠铋飑è狒镯篝蝓泗躜濠扉篝篝蝓泗躜濠磲疸犷＇骒狒翦篝蝓泗躜濠┅荤弭铘屐屙孱镦扉篝ㄤ彐躅珏舡铘璀屐屙孱扉篝铛礅弪铘铛礅弪扉篝┅荤弭翳扉篝箝瀹ㄤ彐躅扉篝箝扉篝ㄩ妯扉篝戾铉翳扉篝ǐ扉篝箝ㄣ潋扉篝┅┅荤弭翳轭溴ㄤ彐躅珏舡轭溴ㄣ栳蜥泗弪扉篝痫箝糸镱扉篝汨狎徙翦颟或弩弭翳铛礅弪鲠祯ㄤ彐躅蝈箦舡鲠祯铛礅弪箦赳铛礅弪癌铛礅弪绘轭铛礅弪镦镢沲蝈钽殄镦箴邈殒殂屐屙孱轭扉篝ㄤ彐躅骈钿镢沲颦泔躅扉篝屐屙孱舂祜镳骘鲠祯轭扉篝泔躅ㄥ聃犰鲠祯屐屙孱舂┅或遽潴翳麒镬骈戾狍铄篝邃汨狎徙翦扉篝ㄤ彐躅蝈徜狍扉篝ㄦ殪孱犴濠箦赳沲蝌孱翥栳蜚秕铘癌箦赳汨狎泔躅癌鏖翳镳孱骈戾篝蝈犴骈戾钺礤ㄤè汨狎蝈徜汨狎篝蝈犴铋飑蝈徜汨狎篝蝈犴铋飑┅è铛祆汨狎┅箦赳汨狎泔躅ǐ汨狎泔躅暴┅ㄣ祜箦篝蝈犴┅箦赳戾趑弪扉篝Ж┅箦赳黠蜾扉篝Ж┅箦赳疳蜥珈轶Ж┅鏖翳镳孱骈戾篝蝈犴骈戾钺礤ㄤè汨狎蝈徜汨狎篝蝈犴铋飑蝈徜汨狎篝蝈犴铋飑┅è铛祆汨狎┅箦赳汨狎箝铉戾腻泔溴翦篝汨狎┅箦赳沲蝌孱翥栳蜚秕铘ǐ沲蝌孱翥栳蜚秕铘暴ㄩㄡ祓栳汨狎汨狎痱镧箦赳戾趑弪扉篝ㄣ镱汨狎戾趑弪扉篝┅┅ㄩ妯羼汨狎＼羽徙濠痱镧箦赳戾趑弪扉篝蝈鲥蝮戾趑弪扉篝┅箦赳黠蜾扉篝ㄡ痧孱黠蜾扉篝扉篝戾趑弪扉篝┅箦赳戾趑弪扉篝Ж┅┅ㄩ妯羼汨狎＼五黛轭濠痱镧箦赳戾趑弪扉篝蝈鲥蝮戾趑弪扉篝┅箦赳黠蜾扉篝ㄡ痧孱黠蜾扉篝扉篝戾趑弪扉篝┅箦赳疳蜥珈轶舁狃疱钿疳蜥珈轶舁扉篝黠蜾扉篝┅箦赳黠蜾扉篝Ж┅箦赳戾趑弪扉篝Ж┅┅ㄩ妯羼沲蝌孱翥栳蜚秕铘汨狎泔躅舂痱镧箦赳戾趑弪扉篝蝈鲥蝮戾趑弪扉篝┅箦赳黠蜾扉篝ㄡ痧孱黠蜾扉篝扉篝戾趑弪扉篝┅箦赳疳蜥珈轶舁狃疱钿疳蜥珈轶舁扉篝黠蜾扉篝┅箦赳黠蜾扉篝Ж┅箦赳戾趑弪扉篝Ж┅┅ㄣ祜箦篝蝈犴┅疳蜥珈轶舂荒邈镤弩翳疳蜥珧狃犭扉铄鏖翳翳桢祓镦溴泔溴犰痂徕弭ㄤ彐躅扉铄溴泔溴ㄤ邈镤邃犰痂徕弭扉铄箦赳矧殓轭犰犰痂徕弭Ж＼＼＼＼＼＼＼绌花箦赳溴泔溴溽祓栳忮Ж＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼＼┅箦赳矧殓轭犰脲磲疸狎＇悴矧殓轭犰犰痂徕弭┅箦赳溴泔溴潆妁磲疸狎＇悴溴泔溴溽祓栳忮舂箦赳脲磲磲疸狎＇溴泔溴潆妁矧殓轭犰脲┅箦赳黠蜾泔躅翦癌箦赳戾趑弪泔躅翦癌箦赳黠蜾扉篝Ж┅箦赳戾趑弪扉篝Ж┅祜镳麒殪黠蜾泔躅翦扉篝箝扉铄┅滹祜镳麒殪戾趑弪泔躅翦颞扉篝箝濞铘黠蜾泔躅翦扉铄┅滹箦赳沲蝌孱翥栳颞铘戾趑弪泔躅翦颞铘黠蜾泔躅翦扉铄┅箦赳沲蝌孱麴矬轸轱铋钿邈镤邃痫箝糸镱沲蝌孱翥栳溴泔溴溽祓栳忮舂箦赳溴泸屙孱綦妁铘沲蝌孱麴矬轸轱铋钿邈镤邃脲磲皓箦赳汨狎鲠祯ㄣ查沲蝌孱翥栳颟箦赳溴泔溴漩犰ō汨狎鲠祯溴泸屙孱綦妁┅箦赳骈钺祆弭翦ㄩ层溴泔溴漩犰┅箦赳骈钺祆弭翦颞轭翦蝾篝蜷铉骈钺祆弭翦颟┅箦赳戾趑弪扉篝ㄣ镱骈钺祆弭翦戾趑弪扉篝┅箦赳戾趑弪泔躅翦ǐ戾趑弪泔躅翦暴箦赳戾趑弪扉篝蝈鲥蝮戾趑弪扉篝┅箦赳黠蜾扉篝ㄡ痧孱黠蜾扉篝扉篝戾趑弪扉篝┅箦赳戾趑弪扉篝Ж┅箦赳戾趑弪泔躅翦癌箦赳黠蜾泔躅翦ǐ黠蜾泔躅翦暴┅黠蜾扉篝诲钽镤弩翳骈戾骘翦篝轭箜犰戾犰痂徕弭ㄤ彐躅箝铉戾腻泔溴翦篝ㄤ邈栳颟ㄣ镱è羼溴汨狎＼箦赳溴汨狎＼姗è羼溴汨狎＼箦赳溴汨狎＼悌è羼溴汨狎＼箦赳溴汨狎＼猢è羼溴汨狎＼箦赳溴汨狎＼岍è羼溴汨狎＼箦赳溴汨狎＼绌è羼溴汨狎＼箦赳溴汨狎＼洎è羼溴汨狎＼箦赳溴汨狎＼濠è羼溴汨狎＼羽徙箦赳溴汨狎＼羽徙濠è羼溴汨狎＼五黛轭箦赳溴汨狎＼五黛轭濠箦赳溴汨狎＼┅┅诲钽镤弩翳骈戾骘翦篝轭ㄡ泗踽犰痂徕弭筢礤轭心譬ㄤ彐躅箝铉戾腻泔溴ㄤ邈栳颟ㄣ镱è羼溴汨狎＼箦赳溴汨狎＼洎è羼溴汨狎＼箦赳溴汨狎＼濠è羼溴汨狎＼箦赳溴汨狎＼姗è羼溴汨狎＼箦赳溴汨狎＼皓è羼溴汨狎＼箦赳溴汨狎＼瘵è羼溴汨狎＼箦赳溴汨狎＼岍è羼溴汨狎＼箦赳溴汨狎＼猢è羼溴汨狎＼箦赳溴汨狎＼氅è羼溴汨狎＼箦赳溴汨狎＼飑è羼溴汨狎＼箦赳溴汨狎＼悌è羼溴汨狎＼箦赳溴汨狎＼颟è羼溴汨狎＼箦赳溴汨狎＼螬è羼溴汨狎＼箦赳溴汨狎＼舂è羼溴汨狎＼箦赳溴汨狎＼绌è羼溴汨狎＼箦赳溴汨狎＼┅è羼溴汨狎＼箦赳溴汨狎＼┅è羼溴汨狎＼箦赳溴汨狎＼瑭è羼溴汨狎＼箦赳溴汨狎＼椹è羼溴汨狎＼箦赳溴汨狎＼戛è羼溴汨狎＼箦赳溴汨狎＼愆è羼溴汨狎＼箦赳溴汨狎＼瞟è羼溴汨狎＼箦赳溴汨狎＼铹è羼溴汨狎＼箦赳溴汨狎＼酴è羼溴汨狎＼箦赳溴汨狎＼雯è羼溴汨狎＼箦赳溴汨狎＼鳗è羼溴汨狎＼箦赳溴汨狎＼┅è羼溴汨狎＼羽徙箦赳溴汨狎＼羽徙濠è羼溴汨狎＼五黛轭箦赳溴汨狎＼五黛轭濠箦赳溴汨狎＼┅┅混轭遽箦狎汨ㄤ彐躅箴屐飙汨邈脲颦黠蜾箦赳骘锃骒徵铋飑戾è轭镳孱溟泗轱钺蝙伯豇簪洪姝滹弩铒舡屮轶铋飑┅麒孱轭祜镳骘扉铄蝈徜扉铄轭铋飑麒殪扉铄滹ㄩ篝蜷铉羼踽黠蜾扉铄┄箦赳骘锃骒徵舂┅ㄣ祜箦轭┅骘锃骒徵会沣弩箝铉黠蜾鲩栳箬磲痧轭绠渝扉铄舶ㄤ彐躅箴屐飙汨邈脲颦黠蜾ㄧ弭栳箬黠蜾黠蜾翎忪濠换换呐孟呐普蚊陨衔换买豸骘蜚礤翳镤ㄤ彐躅清瞽腻泔溴颦疳蜥珧狃瑭箦赳矧殓轭犰犰痂徕弭Ж＼＼＼＼＼＼＼绌箦赳箬蹑骒邃犰痂徕弭Ж＼＼＼＼＼＼＼绌箦赳箬蹑骒邃犰痂徕弭铙桴骀戾箬蹑骒邃犰痂徕弭┅箦赳箝铉戾黠蜾Ж┅箦赳黠蜾泔躅癌祜镳麒殪黠蜾泔躅扉篝箝疳蜥珧狃瑭滹箦赳箝铉戾黠蜾Ж┅箦赳祜麇蜮秕钿癌箦赳躔疱蜮秕钿扉篝箝ㄧ弭铘璀屐屙孱疳蜥珧狃黠蜾泔躅舂┅箦赳轭溴邃黠蜾铘黠蜾泔躅疳蜥珧狃瑭祜镳骘骝镯祜麇蜮秕钿麸ō躔疱蜮秕钿暴泔祆邈糸铉痱镧箦赳轭溴邃戾趑弪铘轭溴邃黠蜾┅箦赳痫箝糸镱轭溴痫箝糸镱轭溴邃戾趑弪箬蹑骒邃犰痂徕弭┅箦赳篚怆妁铘痫箝糸镱轭溴矧殓轭犰犰痂徕弭┅箦赳箝铉戾黠蜾ㄣ镱篚怆妁箝铉戾黠蜾┅箦赳箝铉戾黠蜾蝈鲥蝮箝铉戾黠蜾┅箦赳麸篝蜷铉扉篝麸篝蜷铉箝铉戾黠蜾┅箦赳怙镬遽铞犰箴屐飙汨邈脲颦麸篝蜷铉┅ㄩ妯羼怙镬遽铞犰铋飑痱镧箦赳箬蹑骒邃犰痂徕弭铙桴骀戾箬蹑骒邃犰痂徕弭┅箦赳黠蜾泔躅癌箦赳黠蜾泔躅ǐ黠蜾泔躅暴┅痱轭麸篝蜷铉ㄤ彐躅睐骢钽疳蜥珧狃瑭扉铄溴泔溴箬蹑骒邃犰痂徕弭疳蜥珧狃瑭哗花痱轭睐骢钽疳蜥珧狃瑭睐骢钽疳蜥珧狃瑭宦蝓翦骑蜚湾翳镤鏖翳骝羼蹂钽犷犰箝螽毁秕铄邃祜铉扉铄骘翳轶礤翳镤ㄤ彐躅清瞽腻泔溴颦颅疳蜥珧狃瑭箦赳怛豸屦狎徵蜥痂疳蜥珧狃瑭箦赳骝羼蹂铘泔躅翦癌箦赳镢沲蝈钽铛礅弪Ж┅箦赳疳蜥珧狃瑷骒狒翦疳蜥珧狃瑭花痱轭滹沲礤铘箦赳矧殓轭犰犰痂徕弭Ж＼＼＼＼＼＼＼绌箦赳箬蹑骒邃犰痂徕弭Ж＼＼＼＼＼＼＼绌箦赳盹篝骝羼蹂铘镱弩Ж＼＼＼＼＼＼瞟箦赳孱泔溴滏蝈聃孱麸铄Ж┅箦赳戾趑弪泔躅翦癌箦赳箬蹑骒邃犰痂徕弭铙桴骀戾箬蹑骒邃犰痂徕弭┅箦赳箝铉戾黠蜾Ж┅箦赳黠蜾泔躅癌祜镳麒殪戾趑弪泔躅翦扉篝箝矧殓轭犰犰痂徕弭┅滹箦赳屐屙孱舁泔躅舡糸礤疳蜥珧狃铘戾趑弪泔躅翦矧殓轭犰犰痂徕弭┅箦赳镢沲蝈钽铛礅弪蟥泔铙屐屙孱镢沲蝈钽铛礅弪螬箦赳戾趑弪泔躅翦ǐ戾趑弪泔躅翦暴箦赳镢沲蝈钽铛礅弪蟥蝈鲥蝮镢沲蝈钽铛礅弪螬痱轭镢沲蝈钽铛礅弪螬祜镳麒殪骝羼蹂铘泔躅翦订滹箦赳磲轭溴痫箝糸镱蝈漉沐＇磲镢沲蝈钽铛礅弪螬镢沲蝈钽铛礅弪螬箦赳孱泔溴滏蝈聃孱麸铄蟥泔铙铘磲轭溴矧殓轭犰犰痂徕弭孱泔溴滏蝈聃孱麸铄螬箦翩铘磲轭溴镢沲蝈钽铛礅弪螬癌荤镬溴箬雉痱轭镢沲蝈钽铛礅弪螬箦赳骝羼蹂铘泔躅翦颞骝羼蹂铘泔躅翦暴箦赳孱泔溴滏蝈聃孱麸铄蝈鲥蝮孱泔溴滏蝈聃孱麸铄螬痱轭孱泔溴滏蝈聃孱麸铄螬花痱轭磲镢沲蝈钽铛礅弪螬换换换换换换换换换轫痨屙孱怛豸骘蜚桢蝈祜镳麒殪黠蜾泔躅扉篝箝怛豸屦狎徵蜥痂┅滹箦赳箝铉戾黠蜾Ж┅箦赳祜麇蜮秕钿癌箦赳躔疱蜮秕钿扉篝箝ㄧ弭铘璀屐屙孱怛豸屦狎徵蜥痂黠蜾泔躅舂┅箦赳轭溴邃黠蜾铘黠蜾泔躅怛豸屦狎徵蜥痂┅祜镳骘骝镯祜麇蜮秕钿麸ō躔疱蜮秕钿暴泔祆邈糸铉痱镧箦赳轭溴邃戾趑弪铘轭溴邃黠蜾┅箦赳痫箝糸镱轭溴痫箝糸镱轭溴邃戾趑弪箬蹑骒邃犰痂徕弭┅箦赳篚怆妁铘痫箝糸镱轭溴矧殓轭犰犰痂徕弭┅箦赳箝铉戾黠蜾ㄣ镱篚怆妁箝铉戾黠蜾┅箦赳骝羼蹂铘徜溴癌箦赳箝铉戾黠蜾蝈鲥蝮箝铉戾黠蜾┅祜镳麒殪骝羼蹂铘徜溴订滹箦赳骝羼蹂铘项濞铘骝羼蹂铘徜溴孱泔溴滏蝈聃孱麸铄螬箦赳箝铉戾黠蜾篚怏铘骝羼蹂铘徜溴盹篝骝羼蹂铘镱弩骝羼蹂铘项箝铉戾黠蜾┅箦赳骝羼蹂铘徜溴颞骝羼蹂铘徜溴暴箦赳麸篝蜷铉扉篝麸篝蜷铉箝铉戾黠蜾┅痱轭麸篝蜷铉箦赳怙镬遽铞犰箴屐飙汨邈脲颦麸篝蜷铉┅ㄩ妯羼怙镬遽铞犰铋飑痱镧箦赳箬蹑骒邃犰痂徕弭铙桴骀戾箬蹑骒邃犰痂徕弭┅箦赳黠蜾泔躅癌箦赳黠蜾泔躅ǐ黠蜾泔躅暴┅┅ㄤ彐躅清瞽腻泔溴颦颅疳蜥珧狃瑭基秕箬秕熹轫痨屙孱翳轶骢钽糸镱绘躅泗轱翳狒蝈趱蝾溴泔溴滹沲礤铘ㄤ彐躅蔑溴买遽脲ㄤ镢蹴孱溴泔溴颟箦赳疳蜥珧狃桡秕铘弪癌箦赳溴泔溴淠镢蹴孱Ж┅祜镳麒殪疳蜥珧狃桡秕铘弪扉篝箝滹沲礤铘┅滹箦赳沲蝌孱麴狎徵蜥痂ㄦ躅汜祆溴泔溴铘疳蜥珧狃桡秕铘弪滹沲礤铘┅痱轭⑹躞溴泔溴疳蜥珧狃璁花痱轭沲蝌孱麴狎徵蜥痂箦赳溴泔溴淠镢蹴孱舁狃疱钿溴泔溴淠镢蹴孱舁扉篝沲蝌孱麴狎徵蜥痂┅花痱轭沲蝌孱麴狎徵蜥痂箦赳沲蝌孱麴狎徵蜥痂Ж┅箦赳疳蜥珧狃桡秕铘弪ǐ疳蜥珧狃桡秕铘弪暴┅痱轭溴泔溴淠镢蹴孱舂溴泔溴淠镢蹴孱舂换换藻篝泔溴ㄤ彐躅翦篝唢钸翦篝咪狒ī痱轭箦舡栳箬翎忪濠滹瞌汨犷珏翳轶痱轭⒃弩糸铉痱轭戾è滹蝈徜狍扉篝滹沲礤铘碑豇簪┅痱轭滹悌蔑溴买遽脲滹清瞽腻泔溴颦俩换翦篝泔溴翦篝唢钸翦篝咪狒岍